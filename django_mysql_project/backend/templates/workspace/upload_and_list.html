<!DOCTYPE html>
<html>
<head>
    <title>íŒŒì¼ ì—…ë¡œë“œ ë° ëª©ë¡</title>
</head>
<body>
    <h2>ğŸ“¤íŒŒì¼ ë° í´ë” ì—…ë¡œë“œ</h2>
    
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}

        <p>ğŸ“ í´ë” ì—…ë¡œë“œ:</p>
        <input type="file" name="files" webkitdirectory directory multiple><br><br>

        <p>ğŸ“„ íŒŒì¼ ì—…ë¡œë“œ:</p>
        <input type="file" name="files" multiple><br><br>

        <button type="submit">ì—…ë¡œë“œ</button>
    </form>

    <hr>

    <h2>ğŸ“„ ì—…ë¡œë“œëœ íŒŒì¼ ëª©ë¡</h2>
    <ul>
        {% for file in files %}
            <li>
                <a href="{{ file.file.url }}">{{ file.filepath }}</a>
                ({{ file.uploaded_at }})

                {% if ".png" in file.file.url or ".jpg" in file.file.url or ".jpeg" in file.file.url %}
                    <div><img src="{{ file.file.url }}" width="150"></div>
                {% elif ".txt" in file.file.url or ".py" in file.file.url or ".md" in file.file.url %}
                    <div>
                        <details>
                            <summary>í…ìŠ¤íŠ¸ ë¯¸ë¦¬ë³´ê¸°</summary>
                            <iframe src="{{ file.file.url }}" width="600" height="200"></iframe>
                        </details>
                    </div>
                {% elif ".pdf" in file.file.url %}
                    <div>
                        <details>
                            <summary>PDF ë¯¸ë¦¬ë³´ê¸°</summary>
                            <iframe src="{{ file.file.url }}" width="600" height="300"></iframe>
                        </details>
                    </div>
                {% elif ".xlsx" in file.file.url or ".docx" in file.file.url or ".ppt" in file.file.url or ".pptx" in file.file.url %}
                    <div>
                        <details>
                            <summary>Office ë¬¸ì„œ ë¯¸ë¦¬ë³´ê¸°</summary>
                            <iframe src="https://view.officeapps.live.com/op/embed.aspx?src={{ request.build_absolute_uri|urlencode:file.file.url }}" width="700" height="400" frameborder="0"></iframe>
                        </details>
                    </div>
                {% endif %}

                <form action="{% url 'delete_file' file.id %}" method="post" style="display:inline;">
                    {% csrf_token %}
                    <button type="submit" onclick="return confirm('ì •ë§ ì‚­ì œí• ê¹Œìš”?');">ì‚­ì œ</button>
                </form>
            </li>
        {% empty %}
            <li>ì—…ë¡œë“œëœ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.</li>
        {% endfor %}
    </ul>        

    <hr>

    <h2>ğŸ“‚ Git ì—°ë™ íŒŒì¼ ì—…ë¡œë“œ</h2>

    <form method="post" enctype="multipart/form-data" action="{% url 'upload_and_commit_to_github' %}">
        {% csrf_token %}
        <p>ğŸ“ ê·¸ë£¹ ì´ë¦„:</p>
        <input type="text" name="group_name" required><br><br>

        <p>ğŸŒ¿ ë¸Œëœì¹˜ ì´ë¦„ (ê¸°ë³¸: main):</p>
        <input type="text" name="branch_name" value="main"><br><br>

        <p>ğŸ“ ì»¤ë°‹ ë©”ì‹œì§€:</p>
        <input type="text" name="commit_message" placeholder="ì˜ˆ: ë¬¸ì„œ ì—…ë¡œë“œ"><br><br>

        <p>ğŸ“„ íŒŒì¼ ì—…ë¡œë“œ:</p>
        <input type="file" name="file" required><br><br>

        <button type="submit">Git ì—…ë¡œë“œ</button>
    </form>

    <hr>

    <h2>ğŸ“œ ì»¤ë°‹ íˆìŠ¤í† ë¦¬ ì¡°íšŒ</h2>

    <form method="get" action="{% url 'git_commit_history' %}">
        <p>ğŸ“ ê·¸ë£¹ ì´ë¦„:</p>
        <input type="text" name="group_name" required><br><br>

        <p>ğŸŒ¿ ë¸Œëœì¹˜ ì´ë¦„ (ê¸°ë³¸: main):</p>
        <input type="text" name="branch_name" value="main"><br><br>

        <p>ğŸ“„ íŒŒì¼ ê²½ë¡œ (ì„ íƒ):</p>
        <input type="text" name="file_path" placeholder="ì˜ˆ: README.md"><br><br>

        <button type="submit">íˆìŠ¤í† ë¦¬ ì¡°íšŒ</button>
    </form>

    {% if commits %}
        <h3>ğŸ“˜ ì»¤ë°‹ ëª©ë¡</h3>
        <ul>
            {% for commit in commits %}
                <li>
                    <strong>{{ commit.message }}</strong><br>
                    SHA: {{ commit.sha }}<br>
                    ì‘ì„±ì: {{ commit.author }}<br>
                    ë‚ ì§œ: {{ commit.date }}
                </li>
            {% endfor %}
        </ul>
    {% endif %}
</body>
</html>



